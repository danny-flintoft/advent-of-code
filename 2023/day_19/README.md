Not the prettiest but it works. 

Approach for part 1 is fairly straight forward, just follow the logic.

Approach for part 2 is to start at the ends of the workflows (at 'A' points) and work backwards to infer the range of values that would have been accepted.